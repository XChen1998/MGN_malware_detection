@old_callback = internal global void (i8*, %struct.pcap_pkthdr*, i8*)* null, align 8
@syscall_list = common global [24 x %struct.struct_syscalls] zeroinitializer, align 16
  %1 = alloca i8*, align 8
  %2 = alloca %struct.pcap_pkthdr*, align 8
  %3 = alloca i8*, align 8
  %ip = alloca %struct.sniff_ip*, align 8
  %tcp = alloca %struct.sniff_tcp*, align 8
  %size_ip = alloca i32, align 4
  %size_tcp = alloca i32, align 4
  %sport = alloca i32, align 4
  %dport = alloca i32, align 4
  store i8* %args, i8** %1, align 8
  store %struct.pcap_pkthdr* %header, %struct.pcap_pkthdr** %2, align 8
  store i8* %packet, i8** %3, align 8
  %4 = load i8*, i8** %3, align 8
  %5 = getelementptr inbounds i8, i8* %4, i64 14
  %6 = bitcast i8* %5 to %struct.sniff_ip*
  store %struct.sniff_ip* %6, %struct.sniff_ip** %ip, align 8
  %7 = load %struct.sniff_ip*, %struct.sniff_ip** %ip, align 8
  %8 = getelementptr inbounds %struct.sniff_ip, %struct.sniff_ip* %7, i32 0, i32 0
  %9 = load i8, i8* %8, align 4
  %10 = zext i8 %9 to i32
  %11 = and i32 %10, 15
  %12 = mul nsw i32 %11, 4
  store i32 %12, i32* %size_ip, align 4
  %13 = load i32, i32* %size_ip, align 4
  %14 = icmp slt i32 %13, 20
  %19 = load %struct.sniff_ip*, %struct.sniff_ip** %ip, align 8
  %20 = getelementptr inbounds %struct.sniff_ip, %struct.sniff_ip* %19, i32 0, i32 6
  %21 = load i8, i8* %20, align 1
  %22 = zext i8 %21 to i32
  switch i32 %22, label %24 [
    i32 6, label %23
  ]
