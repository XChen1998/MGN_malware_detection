@LOCAL_ADDR = common global i32 0, align 4
  %647 = load %struct.attack_http_state*, %struct.attack_http_state** %conn, align 8
  %648 = getelementptr inbounds %struct.attack_http_state, %struct.attack_http_state* %647, i32 0, i32 0
  %649 = load i32, i32* %648, align 4
  %650 = icmp ne i32 %649, -1
  %662 = load %struct.attack_http_state*, %struct.attack_http_state** %conn, align 8
  %663 = getelementptr inbounds %struct.attack_http_state, %struct.attack_http_state* %662, i32 0, i32 0
  store i32 %660, i32* %663, align 4
  %664 = icmp eq i32 %660, -1
  call void @table_unlock_val(i8 zeroext 85)
  %539 = load i32, i32* %i, align 4
  %540 = sext i32 %539 to i64
  %541 = load %struct.attack_http_state*, %struct.attack_http_state** %http_table, align 8
  %542 = getelementptr inbounds %struct.attack_http_state, %struct.attack_http_state* %541, i64 %540
  %543 = getelementptr inbounds %struct.attack_http_state, %struct.attack_http_state* %542, i32 0, i32 5
  %544 = getelementptr inbounds [512 x i8], [512 x i8]* %543, i32 0, i32 0
  %548 = call i32 @util_strcpy(i8* %545, i8* %546)
  call void @table_lock_val(i8 zeroext 85)
  %637 = load %struct.attack_http_state*, %struct.attack_http_state** %conn, align 8
  %638 = getelementptr inbounds %struct.attack_http_state, %struct.attack_http_state* %637, i32 0, i32 1
  %639 = load i8, i8* %638, align 4
  %640 = zext i8 %639 to i32
  %641 = icmp eq i32 %640, 0
  %669 = load %struct.attack_http_state*, %struct.attack_http_state** %conn, align 8
  %670 = getelementptr inbounds %struct.attack_http_state, %struct.attack_http_state* %669, i32 0, i32 0
  %671 = load i32, i32* %670, align 4
  %672 = load %struct.attack_http_state*, %struct.attack_http_state** %conn, align 8
  %673 = getelementptr inbounds %struct.attack_http_state, %struct.attack_http_state* %672, i32 0, i32 0
  %674 = load i32, i32* %673, align 4
  %675 = call i32 (i32, i32, ...) @fcntl(i32 %674, i32 3, i32 0)
  %678 = or i32 2048, %676
  %679 = call i32 (i32, i32, ...) @fcntl(i32 %671, i32 4, i32 %678)
