  %17 = load i8*, i8** %2, align 8
  %18 = load i64, i64* %3, align 8
  %19 = call i64 (i8*, i64, ...) @ssh_decode_array(i8* %17, i64 %18, i32 5, i64* %version, i32 219023885)
  %22 = load i64, i64* %3, align 8
  %23 = icmp ne i64 %20, %22
  %14 = getelementptr inbounds [1 x %struct.__va_list_tag], [1 x %struct.__va_list_tag]* %va, i32 0, i32 0
  %15 = bitcast %struct.__va_list_tag* %14 to i8*
  call void @llvm.va_end(i8* %15)
Builtin - llvm.va_end
store %struct.SshFileServerRec* %36, %struct.SshFileServerRec** %server, align 8
store  i64 %37, i64* %id, align 8
store  i32 5, i32* %error, align 8
  %1 = alloca %struct.SshFileServerRec*, align 8
  %2 = alloca i64, align 8
  %3 = alloca i32, align 4
  store %struct.SshFileServerRec* %server, %struct.SshFileServerRec** %1, align 8
  store i64 %id, i64* %2, align 8
  store i32 %error, i32* %3, align 4
  %4 = load %struct.SshFileServerRec*, %struct.SshFileServerRec** %1, align 8
  %5 = load i64, i64* %2, align 8
  %6 = load i32, i32* %3, align 4
  %7 = zext i32 %6 to i64
  call void (%struct.SshFileServerRec*, i32, ...) @ssh_file_server_send(%struct.SshFileServerRec* %4, i32 101, i32 5, i64 %5, i32 5, i64 %7, i32 219023885)
  %10 = call i8* @ssh_xcalloc(i64 1, i64 48)
  %13 = bitcast i8* %11 to %struct.SshFileAttributesRec*
  store %struct.SshFileAttributesRec* %13, %struct.SshFileAttributesRec** %attrs, align 8
  %14 = load i32, i32* %1, align 4
  switch i32 %14, label %1479 [
    i32 1, label %15
    i32 3, label %45
    i32 4, label %172
    i32 5, label %240
    i32 6, label %324
    i32 17, label %384
    i32 7, label %454
    i32 8, label %485
    i32 9, label %532
    i32 10, label %650
    i32 11, label %787
    i32 12, label %847
    i32 13, label %1325
    i32 14, label %1357
    i32 15, label %1403
    i32 16, label %1435
  ]
  call void (i8*, ...) @ssh_warning(i8* getelementptr inbounds ([39 x i8], [39 x i8]* @.str.14, i32 0, i32 0))
  %26 = load %struct.SshFileAttributesRec*, %struct.SshFileAttributesRec** %attrs, align 8
  %27 = bitcast %struct.SshFileAttributesRec* %26 to i8*
  call void @ssh_xfree(i8* %27)
  %28 = load %struct.SshFileServerRec*, %struct.SshFileServerRec** %server, align 8
  %29 = getelementptr inbounds %struct.SshFileServerRec, %struct.SshFileServerRec* %28, i32 0, i32 0
  %30 = load %struct.SshPacketWrapperRec*, %struct.SshPacketWrapperRec** %29, align 8
  %31 = call i32 @ssh_packet_wrapper_can_send(%struct.SshPacketWrapperRec* %30)
  %21 = load %struct.SshServerHandleRec*, %struct.SshServerHandleRec** %handle, align 8
  %22 = getelementptr inbounds %struct.SshServerHandleRec, %struct.SshServerHandleRec* %21, i32 0, i32 1
  %23 = load i8*, i8** %22, align 8
  %24 = load i8*, i8** %3, align 8
  %25 = load i64, i64* %4, align 8
  %26 = call i32 @memcmp(i8* %23, i8* %24, i64 %25) #8
  %29 = icmp eq i32 %27, 0
  %7 = load %struct.SshFileServerRec*, %struct.SshFileServerRec** %1, align 8
  %8 = getelementptr inbounds %struct.SshFileServerRec, %struct.SshFileServerRec* %7, i32 0, i32 0
  %9 = load %struct.SshPacketWrapperRec*, %struct.SshPacketWrapperRec** %8, align 8
  %10 = load i32, i32* %2, align 4
  %11 = getelementptr inbounds [1 x %struct.__va_list_tag], [1 x %struct.__va_list_tag]* %va, i32 0, i32 0
  call void @ssh_packet_wrapper_send_encode_va(%struct.SshPacketWrapperRec* %9, i32 %10, %struct.__va_list_tag* %11)
  %34 = load i64, i64* %version, align 8
  %35 = icmp ult i64 %34, 0
  %1 = alloca %struct.SshFileServerRec*, align 8
  %2 = alloca i32, align 4
  %3 = alloca i8*, align 8
  %4 = alloca i8*, align 8
  %handle = alloca %struct.SshServerHandleRec*, align 8
  store %struct.SshFileServerRec* %server, %struct.SshFileServerRec** %1, align 8
  store i32 %is_directory, i32* %2, align 4
  store i8* %name, i8** %3, align 8
  store i8* %fd, i8** %4, align 8
  %5 = call i8* @ssh_xmalloc(i64 48)
  %8 = bitcast i8* %6 to %struct.SshServerHandleRec*
  store %struct.SshServerHandleRec* %8, %struct.SshServerHandleRec** %handle, align 8
  %9 = load %struct.SshServerHandleRec*, %struct.SshServerHandleRec** %handle, align 8
  %10 = getelementptr inbounds %struct.SshServerHandleRec, %struct.SshServerHandleRec* %9, i32 0, i32 1
  %11 = load %struct.SshServerHandleRec*, %struct.SshServerHandleRec** %handle, align 8
  %12 = ptrtoint %struct.SshServerHandleRec* %11 to i64
  %13 = load i8*, i8** %4, align 8
  %14 = ptrtoint i8* %13 to i64
  %15 = call i64 (i8**, ...) @ssh_encode_alloc(i8** %10, i32 5, i64 %12, i32 5, i64 %14, i32 219023885)
  %14 = load %struct.SshServerHandleRec*, %struct.SshServerHandleRec** %handle, align 8
  %15 = getelementptr inbounds %struct.SshServerHandleRec, %struct.SshServerHandleRec* %14, i32 0, i32 2
  %16 = load i64, i64* %15, align 8
  %17 = load i64, i64* %4, align 8
  %18 = icmp eq i64 %16, %17
  %38 = load i64, i64* %version, align 8
  %43 = phi i64 [ %38, %37 ], [ 0, %40 ]
  store i64 %43, i64* %version, align 8
  %44 = load %struct.SshFileServerRec*, %struct.SshFileServerRec** %server, align 8
  %45 = load i64, i64* %version, align 8
  call void (%struct.SshFileServerRec*, i32, ...) @ssh_file_server_send(%struct.SshFileServerRec* %44, i32 2, i32 5, i64 %45, i32 219023885)
  %46 = load %struct.SshFileAttributesRec*, %struct.SshFileAttributesRec** %attrs, align 8
  %47 = bitcast %struct.SshFileAttributesRec* %46 to i8*
  call void @ssh_xfree(i8* %47)
  %48 = load %struct.SshFileServerRec*, %struct.SshFileServerRec** %server, align 8
  %49 = getelementptr inbounds %struct.SshFileServerRec, %struct.SshFileServerRec* %48, i32 0, i32 0
  %50 = load %struct.SshPacketWrapperRec*, %struct.SshPacketWrapperRec** %49, align 8
  %51 = call i32 @ssh_packet_wrapper_can_send(%struct.SshPacketWrapperRec* %50)
