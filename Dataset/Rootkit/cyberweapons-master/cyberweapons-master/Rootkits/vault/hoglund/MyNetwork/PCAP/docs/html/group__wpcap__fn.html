<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Exported functions</title>
<link href="style.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>Exported functions<br>
<small>
[<a class="el" href="group__wpcap.html">WinPcap user's manual</a>]</small>
</h1><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td nowrap align=right valign=top>typedef void(*&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a0">pcap_handler</a> )(u_char *user, const struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> *pkt_header, const u_char *pkt_data)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Prototype of the callback function that receives the packets.</em> <a href="#a0"></a><em></em></font><br><br></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live</a> (char *device, int <a class="el" href="gencode_8c.html#a23">snaplen</a>, int promisc, int to_ms, char *ebuf)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Deprecated: use the <a class="el" href="group__remote__func.html#a3">pcap_open()</a> instead.</b> Opens a physical interface for live capture.</em> <a href="#a1"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a2">pcap_open_dead</a> (int <a class="el" href="gencode_8c.html#a43">linktype</a>, int <a class="el" href="gencode_8c.html#a23">snaplen</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Deprecated: use the <a class="el" href="group__remote__func.html#a3">pcap_open()</a> instead.</b> Creates a pcap_t structure without starting a capture.</em> <a href="#a2"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline</a> (const char *fname, char *<a class="el" href="inet_8c.html#a5">errbuf</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Deprecated: use the <a class="el" href="group__remote__func.html#a3">pcap_open()</a> instead.</b> Opens a savefile in the tcpdump/libpcap format to read the packets.</em> <a href="#a3"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="group__wpcap__def.html#a3">pcap_dumper_t</a> *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a4">pcap_dump_open</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, const char *fname)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Opens a file to write the network traffic.</em> <a href="#a4"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a5">pcap_setnonblock</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, int nonblock, char *<a class="el" href="inet_8c.html#a5">errbuf</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Switches between blocking and nonblocking mode.</em> <a href="#a5"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a6">pcap_getnonblock</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, char *<a class="el" href="inet_8c.html#a5">errbuf</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Gets the "non-blocking" state of an interface.</em> <a href="#a6"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs</a> (<a class="el" href="structpcap__if.html">pcap_if_t</a> **alldevsp, char *<a class="el" href="inet_8c.html#a5">errbuf</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Deprecated: use the <a class="el" href="group__remote__func.html#a0">pcap_findalldevs_ex()</a> instead.</b> Returns the list of the interfaces available on the system.</em> <a href="#a7"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a8">pcap_freealldevs</a> (<a class="el" href="structpcap__if.html">pcap_if_t</a> *alldevsp)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Frees an interface list returned by <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a>.</em> <a href="#a8"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>char *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a9">pcap_lookupdev</a> (char *<a class="el" href="inet_8c.html#a5">errbuf</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b> Deprecated, use <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a> instead</b>.<br>
 Returns the first valid device in the system.</em> <a href="#a9"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a10">pcap_lookupnet</a> (char *device, <a class="el" href="group__wpcap__def.html#a1">bpf_u_int32</a> *<a class="el" href="inet_8c.html#a3">netp</a>, <a class="el" href="group__wpcap__def.html#a1">bpf_u_int32</a> *<a class="el" href="inet_8c.html#a4">maskp</a>, char *<a class="el" href="inet_8c.html#a5">errbuf</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b> Deprecated, use <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a> instead</b>.<br>
 Returns the subnet and netmask of an interface.</em> <a href="#a10"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, int cnt, <a class="el" href="group__wpcap__fn.html#a0">pcap_handler</a> callback, u_char *user)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Deprecated: use the <a class="el" href="group__wpcap__fn.html#a41">pcap_next_ex()</a> instead.</b> Collects a group of packets. Returns when <b>cnt</b> packets have been received or when the timeout set with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> expires.</em> <a href="#a11"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a12">pcap_loop</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, int cnt, <a class="el" href="group__wpcap__fn.html#a0">pcap_handler</a> callback, u_char *user)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Deprecated: use the <a class="el" href="group__wpcap__fn.html#a41">pcap_next_ex()</a> instead.</b> Collects a group of packets. Returns when <b>cnt</b> packets have been received, but doesn't respect the timeout set with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, therefore it can block forever.</em> <a href="#a12"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a13">pcap_dump</a> (u_char *user, const struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> *h, const u_char *sp)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Saves a packet to disk.</em> <a href="#a13"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a14">pcap_compile</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, struct <a class="el" href="structbpf__program.html">bpf_program</a> *fp, char *str, int optimize, <a class="el" href="group__wpcap__def.html#a1">bpf_u_int32</a> netmask)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Compiles a packet filter. Converts an high level filtering expression (see <a class="el" href="group__language.html">Filtering expression syntax</a> ) in a program that can be interpreted by the kernel-level filtering engine.</em> <a href="#a14"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a15">pcap_compile_nopcap</a> (int snaplen_arg, int linktype_arg, struct <a class="el" href="structbpf__program.html">bpf_program</a> *program, char *buf, int optimize, <a class="el" href="group__wpcap__def.html#a1">bpf_u_int32</a> <a class="el" href="gencode_8c.html#a29">mask</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b> Deprecated, use <a class="el" href="group__wpcap__fn.html#a2">pcap_open_dead()</a> and <a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a> instead </b>.<br>
 Compiles a packet filter without the need of opening an adapter. Converts an high level filtering expression (see <a class="el" href="group__language.html">Filtering expression syntax</a> ) in a program that can be interpreted by the kernel-level filtering engine.</em> <a href="#a15"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a16">pcap_setfilter</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, struct <a class="el" href="structbpf__program.html">bpf_program</a> *fp)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Associates a filter to a capture.</em> <a href="#a16"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a17">pcap_freecode</a> (struct <a class="el" href="structbpf__program.html">bpf_program</a> *fp)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Frees a filter.</em> <a href="#a17"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>u_char *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a18">pcap_next</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> *h)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Discouraged, use <a class="el" href="group__wpcap__fn.html#a41">pcap_next_ex()</a> instead</b>.<br>
 Returns the next available packet.</em> <a href="#a18"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a19">pcap_datalink</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Returns the link layer of an adapter.</em> <a href="#a19"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a20">pcap_snapshot</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Returns the dimension of the packet portion (in bytes) that is delivered to the application.</em> <a href="#a20"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a21">pcap_is_swapped</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>returns true if the current savefile uses a different byte order than the current system.</em> <a href="#a21"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a22">pcap_major_version</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>returns the major version number of the pcap library used to write the savefile.</em> <a href="#a22"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a23">pcap_minor_version</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>returns the minor version number of the pcap library used to write the savefile.</em> <a href="#a23"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a24">pcap_stats</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, struct <a class="el" href="structpcap__stat.html">pcap_stat</a> *ps)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b> Discouraged, Use <a class="el" href="group__wpcap__fn.html#a44">pcap_stats_ex()</a> instead</b>.<br>
 Returns statistics on current capture.</em> <a href="#a24"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>FILE *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a25">pcap_file</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b> Discouraged, use <a class="el" href="group__wpcap__fn.html#a13">pcap_dump()</a> instead</b>.<br>
 Returns the stdio stream of an offile capture.</em> <a href="#a25"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a26">pcap_fileno</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b> Deprecated, handling the device descriptor directly is useless under Win32</b>.<br>
 Returns the file descriptor of a capture device.</em> <a href="#a26"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a27">pcap_perror</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, char *prefix)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>prints the text of the last pcap library error on stderr, prefixed by prefix.</em> <a href="#a27"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>char *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a28">pcap_geterr</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>returns the error text pertaining to the last pcap library error.</em> <a href="#a28"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>char *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a29">pcap_strerror</a> (int error)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><a class="el" href="group__wpcap__fn.html#a29">pcap_strerror()</a> is provided in case strerror() isn't available.</em> <a href="#a29"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>fn void&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a30">pcap_close</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>closes the files associated with p and deallocates resources.</em> <a href="#a30"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>fn void&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a31">pcap_dump_close</a> (<a class="el" href="group__wpcap__def.html#a3">pcap_dumper_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><a class="el" href="group__wpcap__fn.html#a31">pcap_dump_close()</a> closes the "savefile".</em> <a href="#a31"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>fn int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a32">pcap_setbuff</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, int dim)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Sets the size of the kernel buffer associated with an adapter.</em> <a href="#a32"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a33">pcap_setmode</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, int mode)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Sets the working mode of the interface p to mode.</em> <a href="#a33"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a34">pcap_sendpacket</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, u_char *buf, int <a class="el" href="gencode_8c.html#a27">size</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Sends a raw packet.</em> <a href="#a34"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a35">pcap_setmintocopy</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, int <a class="el" href="gencode_8c.html#a27">size</a>)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Sets the minumum amount of data received by the kernel in a single call.</em> <a href="#a35"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>HANDLE&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a36">pcap_getevent</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Returns the handle of the event associated with the interface p.</em> <a href="#a36"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structpcap__send__queue.html">pcap_send_queue</a> *&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a37">pcap_sendqueue_alloc</a> (u_int memsize)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Allocate a send queue.</em> <a href="#a37"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a38">pcap_sendqueue_destroy</a> (<a class="el" href="structpcap__send__queue.html">pcap_send_queue</a> *queue)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Destroy a send queue.</em> <a href="#a38"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a39">pcap_sendqueue_queue</a> (<a class="el" href="structpcap__send__queue.html">pcap_send_queue</a> *queue, const struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> *pkt_header, const u_char *pkt_data)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Add a packet to a send queue.</em> <a href="#a39"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>u_int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a40">pcap_sendqueue_transmit</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, <a class="el" href="structpcap__send__queue.html">pcap_send_queue</a> *queue, int sync)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Sends a queue of raw packets to the network.</em> <a href="#a40"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a41">pcap_next_ex</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> **pkt_header, u_char **pkt_data)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Read a packet from an interface or from an offline capture.</em> <a href="#a41"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a42">pcap_live_dump</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, char *filename, int maxsize, int maxpacks)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Saves a capture to file.</em> <a href="#a42"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a43">pcap_live_dump_ended</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, int sync)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b>Win32 Specific.</b> Returns the status of the kernel dump process, i.e. tells if one of the limits defined with <a class="el" href="group__wpcap__fn.html#a42">pcap_live_dump()</a> has been reached.</em> <a href="#a43"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="group__wpcap__fn.html#a44">pcap_stats_ex</a> (<a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *p, struct <a class="el" href="structpcap__stat.html">pcap_stat</a> *ps)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em><b> Win32 Specific.</b> Returns statistics on current capture.</em> <a href="#a44"></a><em></em></font><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Functions exported by wpcap.dll <hr><h2>Typedef Documentation</h2>
<a name="a0" doxytag="funcs/pcap.h::pcap_handler"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef void(* pcap_handler)(u_char *user, const struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> *pkt_header, const u_char *pkt_data)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Prototype of the callback function that receives the packets.
<p>
When <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> or <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a> are called by the user, the packets are passed to the application by means of this callback. user is a user-defined parameter that contains the state of the capture session, it corresponds to the <em>user</em> parameter of <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> and <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a>. pkt_header is the header associated by the capture driver to the packet. It is NOT a protocol header. pkt_data points to the data of the packet, including the protocol headers. 
<p>
Definition at line <a class="el" href="funcs_2pcap_8h-source.html#l00786">786</a> of file <a class="el" href="funcs_2pcap_8h-source.html">funcs/pcap.h</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a30" doxytag="funcs/pcap.h::pcap_close"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> fn void pcap_close </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
closes the files associated with p and deallocates resources.
<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a>, <a class="el" href="group__wpcap__fn.html#a2">pcap_open_dead()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00653">653</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
References <a class="el" href="Packet32_8c-source.html#l00666">PacketCloseAdapter()</a>, <a class="el" href="pcap-remote_8c-source.html#l00300">pcap_close_remote()</a>, and <a class="el" href="gencode_8c-source.html#l00384">pcap_freecode()</a>.
<p>
Referenced by <a class="el" href="inet_8c-source.html#l00132">add_or_find_if()</a>, <a class="el" href="daemon_8c-source.html#l01116">daemon_endcapture()</a>, <a class="el" href="daemon_8c-source.html#l00820">daemon_opensource()</a>, <a class="el" href="daemon_8c-source.html#l00104">daemon_serviceloop()</a>, <a class="el" href="daemon_8c-source.html#l00903">daemon_startcapture()</a>, <a class="el" href="gencode_8c-source.html#l00364">pcap_compile_nopcap()</a>, <a class="el" href="pcap-remote_8c-source.html#l00554">pcap_opensource_remote()</a>, and <a class="el" href="pcap-remote_8c-source.html#l00761">pcap_startcapture_remote()</a>.    </td>
  </tr>
</table>
<a name="a14" doxytag="funcs/pcap.h::pcap_compile"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_compile </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structbpf__program.html">bpf_program</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>fp</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>str</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>optimize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="group__wpcap__def.html#a1">bpf_u_int32</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>netmask</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Compiles a packet filter. Converts an high level filtering expression (see <a class="el" href="group__language.html">Filtering expression syntax</a> ) in a program that can be interpreted by the kernel-level filtering engine.
<p>
<a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a> is used to compile the string str into a filter program. program is a pointer to a <a class="el" href="structbpf__program.html">bpf_program</a> struct and is filled in by <a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a>. optimize controls whether optimization on the resulting code is performed. netmask specifies the netmask of the local net. A return of -1 indicates an error in which case <a class="el" href="group__wpcap__fn.html#a28">pcap_geterr()</a> may be used to display the error text.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a16">pcap_setfilter()</a>, <a class="el" href="group__wpcap__fn.html#a17">pcap_freecode()</a>, <a class="el" href="group__wpcap__fn.html#a20">pcap_snapshot()</a> </dd></dl>

<p>
Definition at line <a class="el" href="gencode_8c-source.html#l00310">310</a> of file <a class="el" href="gencode_8c-source.html">gencode.c</a>.
<p>
References <a class="el" href="Packet32_8h-source.html#l00105">bpf_program::bf_insns</a>, <a class="el" href="Packet32_8h-source.html#l00104">bpf_program::bf_len</a>, <a class="el" href="gencode_8c-source.html#l00108">bpf_error()</a>, <a class="el" href="gencode_8c-source.html#l00094">bpf_pcap</a>, <a class="el" href="gencode_8c.html#a69">freechunks()</a>, <a class="el" href="gencode_8c.html#a72">gen_retblk()</a>, <a class="el" href="gencode_8c.html#a115">init_linktype()</a>, <a class="el" href="gencode_8c-source.html#l02447">mask</a>, <a class="el" href="gencode_8c-source.html#l00307">no_optimize</a>, <a class="el" href="pcap_8c-source.html#l00209">pcap_datalink()</a>, <a class="el" href="pcap_8c-source.html#l00438">pcap_snapshot()</a>, <a class="el" href="gencode_8c-source.html#l00127">root</a>, <a class="el" href="gencode_8c-source.html#l00306">snaplen</a>, <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>, and <a class="el" href="gencode_8c.html#a73">syntax()</a>.
<p>
Referenced by <a class="el" href="pcap__filter_8c-source.html#l00035">main()</a>, and <a class="el" href="gencode_8c-source.html#l00364">pcap_compile_nopcap()</a>.    </td>
  </tr>
</table>
<a name="a15" doxytag="funcs/pcap.h::pcap_compile_nopcap"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_compile_nopcap </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>snaplen_arg</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>linktype_arg</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structbpf__program.html">bpf_program</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>program</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>buf</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>optimize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="group__wpcap__def.html#a1">bpf_u_int32</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>mask</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b> Deprecated, use <a class="el" href="group__wpcap__fn.html#a2">pcap_open_dead()</a> and <a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a> instead </b>.<br>
 Compiles a packet filter without the need of opening an adapter. Converts an high level filtering expression (see <a class="el" href="group__language.html">Filtering expression syntax</a> ) in a program that can be interpreted by the kernel-level filtering engine.
<p>
<a class="el" href="group__wpcap__fn.html#a15">pcap_compile_nopcap()</a> is similar to <a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a> except that instead of passing a pcap structure, one passes the snaplen and linktype explicitly. It is intended to be used for compiling filters for direct BPF usage, without necessarily having called <a class="el" href="group__remote__func.html#a3">pcap_open()</a>. A return of -1 indicates an error; the error text is unavailable. (<a class="el" href="group__wpcap__fn.html#a15">pcap_compile_nopcap()</a> is a wrapper around <a class="el" href="group__wpcap__fn.html#a2">pcap_open_dead()</a>, <a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a>, and <a class="el" href="group__wpcap__fn.html#a30">pcap_close()</a>; the latter three routines can be used directly in order to get the error text for a compilation error.)<p>
Look at the <a class="el" href="group__language.html">Filtering expression syntax</a> section for details on the str parameter.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a16">pcap_setfilter()</a>, <a class="el" href="group__wpcap__fn.html#a17">pcap_freecode()</a>, <a class="el" href="group__wpcap__fn.html#a20">pcap_snapshot()</a> </dd></dl>

<p>
Definition at line <a class="el" href="gencode_8c-source.html#l00364">364</a> of file <a class="el" href="gencode_8c-source.html">gencode.c</a>.
<p>
References <a class="el" href="pcap_8c-source.html#l00653">pcap_close()</a>, <a class="el" href="gencode_8c-source.html#l00310">pcap_compile()</a>, <a class="el" href="pcap_8c-source.html#l00634">pcap_open_dead()</a>, and <a class="el" href="incs_2pcap_8h-source.html#l00070">pcap_t</a>.    </td>
  </tr>
</table>
<a name="a19" doxytag="funcs/pcap.h::pcap_datalink"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_datalink </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the link layer of an adapter.
<p>
<a class="el" href="group__wpcap__fn.html#a19">pcap_datalink()</a> returns the link layer type; link layer types it can return include:<ul>
<li>DLT_NULL BSD loopback encapsulation; the link layer header is a 4-byte field, in host byte order, containing a PF_ value from socket.h for the network-layer protocol of the packet Note that "host byte order" is the byte order of the machine on which the packets are captured, and the PF_ values are for the OS of the machine on which the packets are captured; if a live capture is being done, "host byte order" is the byte order of the machine capturing the packets, and the PF_ values are those of the OS of the machine capturing the packets, but if a "savefile" is being read, the byte order and PF_ values are not necessarily those of the machine reading the capture file.</li><li>DLT_EN10MB Ethernet (10Mb, 100Mb, 1000Mb, and up)</li><li>DLT_IEEE802 IEEE 802.5 Token Ring</li><li>DLT_ARCNET ARCNET SLIP; the link layer header contains, in order: a 1-byte flag, which is 0 for packets received by the machine and 1 for packets sent by the machine; a 1-byte field, the upper 4 bits of which indicate the type of packet, as per RFC 1144:<ul>
<li>0x40 an unmodified IP datagram (TYPE_IP);</li><li>0x70 an uncompressed-TCP IP datagram (UNCOMPRESSED_TCP), with that byte being the first byte of the raw IP header on the wire, containing the connection number in the protocol field;</li><li>0x80 a compressed-TCP IP datagram (COMPRESSED_TCP), with that byte being the first byte of the compressed TCP/IP datagram header; for UNCOMPRESSED_TCP, the rest of the modified IP header, and for COMPRESSED_TCP, the compressed TCP/IP datagram header; for a total of 16 bytes; the uncompressed IP datagram follows the header</li></ul>
</li><li>DLT_PPP PPP; if the first 2 bytes are 0xff and 0x03, it's PPP in HDLC-like framing, with the PPP header following those two bytes, otherwise it's PPP without framing, and the packet begins with the PPP header</li><li>DLT_FDDI FDDI</li><li>DLT_ATM_RFC1483 RFC 1483 LLC/SNAP-encapsulated ATM; the packet begins with an IEEE 802.2 LLC header</li><li>DLT_RAW raw IP; the packet begins with an IP header</li><li>DLT_PPP_SERIAL PPP in HDLC-like framing, as per RFC 1662, or Cisco PPP with HDLC framing, as per section or 0x8F for Cisco PPP with HDLC framing</li><li>DLT_PPP_ETHER PPPoE; the packet begins with a PPPoE header, as per RFC 2516</li><li>DLT_C_HDLC Cisco PPP with HDLC framing, as per section 4.3.1 of RFC 1547</li><li>DLT_IEEE802_11 IEEE 802.11 wireless LAN</li><li>DLT_LOOP OpenBSD loopback encapsulation; the link layer header is a 4-byte field, in network byte order, containing a PF_ value from OpenBSD's socket.h for the network-layer protocol of the packet Note that, if a "savefile" is being read, those PF_ values are not necessarily those of the machine reading the capture file.</li><li>DLT_LINUX_SLL Linux "cooked" capture encapsulation; the link layer header contains, in order: a 2-byte "packet type", in network byte order, which is one of:<ul>
<li>0 packet was sent to us by somebody else</li><li>1 packet was broadcast by somebody else</li><li>2 packet was multicast, but not broadcast, by somebody else</li><li>3 packet was sent by somebody else to somebody else</li><li>4 packet was sent by us a 2-byte field, in network byte order, containing a Linux ARPHRD_ value for the link layer device type; a 2-byte field, in network byte order, containing the length of the link layer address of the sender of the packet (which could be 0); bytes of the link layer header (if there are more than 8 bytes, only the first 8 are present); a 2-byte field containing an Ethernet protocol type, in network byte order, or containing 1 for Novell 802.3 frames without an 802.2 LLC header or 4 for frames beginning with an 802.2 LLC header.</li></ul>
</li><li>DLT_LTALK Apple LocalTalk; the packet begins with an AppleTalk LLAP header </li></ul>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00209">209</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
Referenced by <a class="el" href="gencode_8c-source.html#l00310">pcap_compile()</a>.    </td>
  </tr>
</table>
<a name="a11" doxytag="funcs/pcap.h::pcap_dispatch"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_dispatch </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cnt</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="group__wpcap__fn.html#a0">pcap_handler</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>callback</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u_char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>user</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Deprecated: use the <a class="el" href="group__wpcap__fn.html#a41">pcap_next_ex()</a> instead.</b> Collects a group of packets. Returns when <b>cnt</b> packets have been received or when the timeout set with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> expires.
<p>
<a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> is used to collect and process packets. cnt specifies the maximum number of packets to process before returning. This is not a minimum number; when reading a live capture, only one bufferful of packets is read at a time, so fewer than cnt packets may be processed. A cnt of -1 processes all the packets received in one buffer when reading a live capture, or all the packets in the file when reading a "savefile". callback specifies a routine to be called with three arguments: a u_char pointer which is passed in from <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a>, a pointer packet data.<p>
The number of packets read is returned. 0 is returned if no packets were read from a live capture (if, for example, they were discarded because they didn't pass the packet filter, or if, on platforms that support a read timeout that starts before any packets arrive, the timeout expires before any packets arrive, or if the file descriptor for the capture device is in non-blocking mode and no packets were available to be read) or if no more packets are available in a "savefile." A return of -1 indicates an error in which case <a class="el" href="group__wpcap__fn.html#a27">pcap_perror()</a> or <a class="el" href="group__wpcap__fn.html#a28">pcap_geterr()</a> may be used to display the error text.<p>
<dl compact><dt><b>Note:</b></dt><dd>when reading a live capture, <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> will not necessarily return when the read times out; on some platforms, the read timeout isn't supported, and, on other platforms, the timer doesn't start until at least one packet arrives. This means that the read timeout should NOT be used in, for example, an interactive application, to allow the packet capture loop to "poll" for user input periodically, as there's no guarantee that <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> will return after the timeout expires.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a>, <a class="el" href="group__wpcap__fn.html#a18">pcap_next()</a>, <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a>, <a class="el" href="group__wpcap__fn.html#a0">pcap_handler</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00069">69</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
References <a class="el" href="savefile_8c-source.html#l00619">pcap_offline_read()</a>, and <a class="el" href="Pcap-win32_8c-source.html#l00079">pcap_read()</a>.
<p>
Referenced by <a class="el" href="pcap_8c-source.html#l00119">pcap_next()</a>.    </td>
  </tr>
</table>
<a name="a13" doxytag="funcs/pcap.h::pcap_dump"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void pcap_dump </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">u_char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>user</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>h</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const u_char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Saves a packet to disk.
<p>
<a class="el" href="group__wpcap__fn.html#a13">pcap_dump()</a> outputs a packet to the "savefile" opened with <a class="el" href="group__wpcap__fn.html#a4">pcap_dump_open()</a>. Note that its calling arguments are suitable for use with <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> or <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a>. If called directly, the user parameter is of type pcap_dumper_t as returned by <a class="el" href="group__wpcap__fn.html#a4">pcap_dump_open()</a>.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a4">pcap_dump_open()</a>, <a class="el" href="group__wpcap__fn.html#a31">pcap_dump_close()</a>, <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a>, <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a> </dd></dl>

<p>
Definition at line <a class="el" href="savefile_8c-source.html#l00650">650</a> of file <a class="el" href="savefile_8c-source.html">savefile.c</a>.
<p>
References <a class="el" href="incs_2pcap_8h-source.html#l00128">pcap_pkthdr::caplen</a>, <a class="el" href="incs_2pcap_8h-source.html#l00129">pcap_pkthdr::len</a>, and <a class="el" href="incs_2pcap_8h-source.html#l00127">pcap_pkthdr::ts</a>.
<p>
Referenced by <a class="el" href="pcap__filter_8c-source.html#l00147">dispatcher_handler()</a>.    </td>
  </tr>
</table>
<a name="a31" doxytag="funcs/pcap.h::pcap_dump_close"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> fn void pcap_dump_close </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a3">pcap_dumper_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<a class="el" href="group__wpcap__fn.html#a31">pcap_dump_close()</a> closes the "savefile".
<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a4">pcap_dump_open()</a>, <a class="el" href="group__wpcap__fn.html#a13">pcap_dump()</a> </dd></dl>

<p>
Definition at line <a class="el" href="savefile_8c-source.html#l00715">715</a> of file <a class="el" href="savefile_8c-source.html">savefile.c</a>.    </td>
  </tr>
</table>
<a name="a4" doxytag="funcs/pcap.h::pcap_dump_open"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="group__wpcap__def.html#a3">pcap_dumper_t</a>* pcap_dump_open </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>fname</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Opens a file to write the network traffic.
<p>
<a class="el" href="group__wpcap__fn.html#a4">pcap_dump_open()</a> is called to open a "savefile" for writing. fname is the name of the file to open. The name "-" in a synonym for stdout. If NULL is returned, <a class="el" href="group__wpcap__fn.html#a28">pcap_geterr()</a> can be used to get the error text.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a31">pcap_dump_close()</a>, <a class="el" href="group__wpcap__fn.html#a25">pcap_file()</a>, <a class="el" href="group__wpcap__fn.html#a13">pcap_dump</a> () </dd></dl>

<p>
Definition at line <a class="el" href="savefile_8c-source.html#l00669">669</a> of file <a class="el" href="savefile_8c-source.html">savefile.c</a>.
<p>
References <a class="el" href="savefile_8c-source.html#l00320">dlt_to_linktype()</a>, <a class="el" href="incs_2pcap_8h-source.html#l00071">pcap_dumper_t</a>, <a class="el" href="pcap_8c-source.html#l00617">pcap_strerror()</a>, <a class="el" href="savefile_8c-source.html#l00356">sf_write_header()</a>, and <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.
<p>
Referenced by <a class="el" href="pcap__filter_8c-source.html#l00035">main()</a>.    </td>
  </tr>
</table>
<a name="a25" doxytag="funcs/pcap.h::pcap_file"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> FILE* pcap_file </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b> Discouraged, use <a class="el" href="group__wpcap__fn.html#a13">pcap_dump()</a> instead</b>.<br>
 Returns the stdio stream of an offile capture.
<p>
<a class="el" href="group__wpcap__fn.html#a25">pcap_file()</a> returns the standard I/O stream of the "savefile", if a "savefile" was opened with <a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a>, or NULL, if a network device was opened with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a>, <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00462">462</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.    </td>
  </tr>
</table>
<a name="a26" doxytag="funcs/pcap.h::pcap_fileno"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_fileno </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b> Deprecated, handling the device descriptor directly is useless under Win32</b>.<br>
 Returns the file descriptor of a capture device.
<p>
<a class="el" href="group__wpcap__fn.html#a26">pcap_fileno()</a> returns the file descriptor number from which captured packets are read, if a network device was opened with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, or -1, if a "savefile" was opened with <a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a>.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a>, <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00468">468</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.    </td>
  </tr>
</table>
<a name="a7" doxytag="funcs/pcap.h::pcap_findalldevs"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_findalldevs </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structpcap__if.html">pcap_if_t</a> **&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>alldevsp</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>errbuf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Deprecated: use the <a class="el" href="group__remote__func.html#a0">pcap_findalldevs_ex()</a> instead.</b> Returns the list of the interfaces available on the system.
<p>
<a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a> constructs a list of network devices that can be opened with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>. (Note that there may be network devices that cannot be opened with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> by the process calling <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a>, because, for example, that process might not have sufficient privileges to open them for capturing; if so, those devices will not appear on the list.) alldevsp is set to point to the first element of the list; each element of the list is of type pcap_if_t.<p>
<dl compact><dt><b>See also:</b></dt><dd>struct <a class="el" href="structpcap__if.html">pcap_if</a>, <a class="el" href="group__wpcap__fn.html#a8">pcap_freealldevs()</a>, <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a9">pcap_lookupdev()</a>, <a class="el" href="group__wpcap__fn.html#a10">pcap_lookupnet()</a> </dd></dl>

<p>
Referenced by <a class="el" href="daemon_8c-source.html#l00692">daemon_findalldevs()</a>, <a class="el" href="basic__dump_8c-source.html#l00006">main()</a>, and <a class="el" href="pcap-new_8c-source.html#l00150">pcap_findalldevs_ex()</a>.    </td>
  </tr>
</table>
<a name="a8" doxytag="funcs/pcap.h::pcap_freealldevs"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void pcap_freealldevs </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structpcap__if.html">pcap_if_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>alldevsp</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Frees an interface list returned by <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a>.
<p>
<a class="el" href="group__wpcap__fn.html#a8">pcap_freealldevs()</a> is used to free a list allocated by <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a>.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a> </dd></dl>

<p>
Definition at line <a class="el" href="inet_8c-source.html#l00426">426</a> of file <a class="el" href="inet_8c-source.html">inet.c</a>.
<p>
References <a class="el" href="incs_2pcap_8h-source.html#l00163">pcap_addr::addr</a>, <a class="el" href="incs_2pcap_8h-source.html#l00152">pcap_if::addresses</a>, <a class="el" href="incs_2pcap_8h-source.html#l00165">pcap_addr::broadaddr</a>, <a class="el" href="incs_2pcap_8h-source.html#l00151">pcap_if::description</a>, <a class="el" href="incs_2pcap_8h-source.html#l00166">pcap_addr::dstaddr</a>, <a class="el" href="incs_2pcap_8h-source.html#l00150">pcap_if::name</a>, <a class="el" href="incs_2pcap_8h-source.html#l00164">pcap_addr::netmask</a>, <a class="el" href="incs_2pcap_8h-source.html#l00149">pcap_if::next</a>, and <a class="el" href="incs_2pcap_8h-source.html#l00162">pcap_addr::next</a>.
<p>
Referenced by <a class="el" href="daemon_8c-source.html#l00692">daemon_findalldevs()</a>, and <a class="el" href="basic__dump_8c-source.html#l00006">main()</a>.    </td>
  </tr>
</table>
<a name="a17" doxytag="funcs/pcap.h::pcap_freecode"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void pcap_freecode </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structbpf__program.html">bpf_program</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>fp</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Frees a filter.
<p>
<a class="el" href="group__wpcap__fn.html#a17">pcap_freecode()</a> is used to free up allocated memory pointed to by a <a class="el" href="structbpf__program.html">bpf_program</a> struct generated by <a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a> when that BPF program is no longer needed, for example after it has been made the filter program for a pcap structure by a call to <a class="el" href="group__wpcap__fn.html#a16">pcap_setfilter()</a>.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a>, <a class="el" href="group__wpcap__fn.html#a15">pcap_compile_nopcap()</a> </dd></dl>

<p>
Definition at line <a class="el" href="gencode_8c-source.html#l00384">384</a> of file <a class="el" href="gencode_8c-source.html">gencode.c</a>.
<p>
References <a class="el" href="Packet32_8h-source.html#l00105">bpf_program::bf_insns</a>, and <a class="el" href="Packet32_8h-source.html#l00104">bpf_program::bf_len</a>.
<p>
Referenced by <a class="el" href="pcap_8c-source.html#l00653">pcap_close()</a>.    </td>
  </tr>
</table>
<a name="a28" doxytag="funcs/pcap.h::pcap_geterr"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* pcap_geterr </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns the error text pertaining to the last pcap library error.
<p>
<dl compact><dt><b>Note:</b></dt><dd>the pointer it returns will no longer point to a valid error message string after the pcap_t passed to it is closed; you must use or copy the string before closing the pcap_t.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a27">pcap_perror()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00487">487</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
Referenced by <a class="el" href="gencode_8c-source.html#l00108">bpf_error()</a>, and <a class="el" href="daemon_8c-source.html#l01323">daemon_thrdatamain()</a>.    </td>
  </tr>
</table>
<a name="a36" doxytag="funcs/pcap.h::pcap_getevent"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE pcap_getevent </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Returns the handle of the event associated with the interface p.
<p>
This event can be passed to functions like WaitForSingleObject() or WaitForMultipleObjects() to wait until the driver's buffer contains some data without performing a read.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Win32-Extensions_8c-source.html#l00031">31</a> of file <a class="el" href="Win32-Extensions_8c-source.html">Win32-Extensions.c</a>.    </td>
  </tr>
</table>
<a name="a6" doxytag="funcs/pcap.h::pcap_getnonblock"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_getnonblock </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>errbuf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Gets the "non-blocking" state of an interface.
<p>
<a class="el" href="group__wpcap__fn.html#a6">pcap_getnonblock()</a> returns the current "non-blocking" state of the capture descriptor; it always returns 0 on "savefiles". If there is an error, -1 is returned and errbuf is filled in with an appropriate error message.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a5">pcap_setnonblock()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00498">498</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
References <a class="el" href="pcap_8c-source.html#l00617">pcap_strerror()</a>, and <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.    </td>
  </tr>
</table>
<a name="a21" doxytag="funcs/pcap.h::pcap_is_swapped"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_is_swapped </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns true if the current savefile uses a different byte order than the current system.
<p>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00444">444</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.    </td>
  </tr>
</table>
<a name="a42" doxytag="funcs/pcap.h::pcap_live_dump"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_live_dump </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>filename</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>maxsize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>maxpacks</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Saves a capture to file.
<p>
<a class="el" href="group__wpcap__fn.html#a42">pcap_live_dump()</a> dumps the network traffic from an interface to a file. Using this function the dump is performed at kernel level, therefore it is more efficient than using <a class="el" href="group__wpcap__fn.html#a13">pcap_dump()</a>.<p>
The parameters of this function are an interface descriptor (obtained with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>), a string with the name of the dump file, the maximum size of the file (in bytes) and the maximum number of packets that the file will contain. Setting maxsize or maxpacks to 0 means no limit. When maxsize or maxpacks are reached, the dump ends.<p>
<a class="el" href="group__wpcap__fn.html#a42">pcap_live_dump()</a> is non-blocking, threfore it returns immediately. <a class="el" href="group__wpcap__fn.html#a43">pcap_live_dump_ended()</a> can be used to check the status of the dump process or to wait until it is finished. <a class="el" href="group__wpcap__fn.html#a30">pcap_close()</a> can instead be used to end the dump process.<p>
Note that when one of the two limits is reached, the dump is stopped, but the file remains opened. In order to correctly flush the data and put the file in a consistent state, the adapter must be closed with <a class="el" href="group__wpcap__fn.html#a30">pcap_close()</a>.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a43">pcap_live_dump_ended()</a>, <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a30">pcap_close()</a>, <a class="el" href="group__wpcap__fn.html#a4">pcap_dump_open()</a>, <a class="el" href="group__wpcap__fn.html#a13">pcap_dump()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Win32-Extensions_8c-source.html#l00298">298</a> of file <a class="el" href="Win32-Extensions_8c-source.html">Win32-Extensions.c</a>.    </td>
  </tr>
</table>
<a name="a43" doxytag="funcs/pcap.h::pcap_live_dump_ended"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_live_dump_ended </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sync</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Returns the status of the kernel dump process, i.e. tells if one of the limits defined with <a class="el" href="group__wpcap__fn.html#a42">pcap_live_dump()</a> has been reached.
<p>
<a class="el" href="group__wpcap__fn.html#a43">pcap_live_dump_ended()</a> informs the user about the limits that were set with a previous call to <a class="el" href="group__wpcap__fn.html#a42">pcap_live_dump()</a> on the interface pointed by p: if the return value is nonzero, one of the limits has been reched and the dump process is currently stopped.<p>
If sync is nonzero, the function blocks until the dump is finished, otherwise it returns immediately.<p>
<dl compact><dt><b>Warning:</b></dt><dd>if the dump process has no limits (i.e. if the maxsize and maxpacks arguments of <a class="el" href="group__wpcap__fn.html#a42">pcap_live_dump()</a> were both 0), the dump process will never stop, therefore setting sync to TRUE will block the application on this call forever.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a42">pcap_live_dump()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Win32-Extensions_8c-source.html#l00329">329</a> of file <a class="el" href="Win32-Extensions_8c-source.html">Win32-Extensions.c</a>.    </td>
  </tr>
</table>
<a name="a9" doxytag="funcs/pcap.h::pcap_lookupdev"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* pcap_lookupdev </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>errbuf</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b> Deprecated, use <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a> instead</b>.<br>
 Returns the first valid device in the system.
<p>
<a class="el" href="group__wpcap__fn.html#a9">pcap_lookupdev()</a> returns a pointer to a network device suitable for use with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> and <a class="el" href="group__wpcap__fn.html#a10">pcap_lookupnet()</a>. If there is an error, NULL is returned and errbuf is filled in with an appropriate error message.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a>, <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> </dd></dl>
    </td>
  </tr>
</table>
<a name="a10" doxytag="funcs/pcap.h::pcap_lookupnet"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_lookupnet </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>device</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="group__wpcap__def.html#a1">bpf_u_int32</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>netp</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="group__wpcap__def.html#a1">bpf_u_int32</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>maskp</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>errbuf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b> Deprecated, use <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a> instead</b>.<br>
 Returns the subnet and netmask of an interface.
<p>
<a class="el" href="group__wpcap__fn.html#a10">pcap_lookupnet()</a> is used to determine the network number and mask associated with the network device device. Both netp and maskp are bpf_u_int32 pointers. A return of -1 indicates an error in which case errbuf is filled in with an appropriate error message.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a> </dd></dl>

<p>
Referenced by <a class="el" href="pcap__filter_8c-source.html#l00035">main()</a>.    </td>
  </tr>
</table>
<a name="a12" doxytag="funcs/pcap.h::pcap_loop"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_loop </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cnt</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="group__wpcap__fn.html#a0">pcap_handler</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>callback</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u_char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>user</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Deprecated: use the <a class="el" href="group__wpcap__fn.html#a41">pcap_next_ex()</a> instead.</b> Collects a group of packets. Returns when <b>cnt</b> packets have been received, but doesn't respect the timeout set with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, therefore it can block forever.
<p>
<a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a> is similar to <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> except it keeps reading packets until cnt packets are processed or an error occurs. It does not return when live read timeouts occur. Rather, specifying a non-zero read timeout to <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> and then calling <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> allows the reception and processing of any packets that arrive when the timeout occurs. A negative cnt causes <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a> to loop forever (or at least until an error occur s).<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a>, <a class="el" href="group__wpcap__fn.html#a18">pcap_next()</a>, <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a>, <a class="el" href="group__wpcap__fn.html#a0">pcap_handler</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00078">78</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
References <a class="el" href="bpf__image_8c-source.html#l00043">n</a>, <a class="el" href="savefile_8c-source.html#l00619">pcap_offline_read()</a>, and <a class="el" href="Pcap-win32_8c-source.html#l00079">pcap_read()</a>.
<p>
Referenced by <a class="el" href="basic__dump_8c-source.html#l00006">main()</a>.    </td>
  </tr>
</table>
<a name="a22" doxytag="funcs/pcap.h::pcap_major_version"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_major_version </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns the major version number of the pcap library used to write the savefile.
<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a23">pcap_minor_version()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00450">450</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.    </td>
  </tr>
</table>
<a name="a23" doxytag="funcs/pcap.h::pcap_minor_version"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_minor_version </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns the minor version number of the pcap library used to write the savefile.
<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a22">pcap_major_version()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00456">456</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.    </td>
  </tr>
</table>
<a name="a18" doxytag="funcs/pcap.h::pcap_next"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> u_char* pcap_next </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>h</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Discouraged, use <a class="el" href="group__wpcap__fn.html#a41">pcap_next_ex()</a> instead</b>.<br>
 Returns the next available packet.
<p>
<a class="el" href="group__wpcap__fn.html#a18">pcap_next()</a> reads the next packet (by calling <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> with a cnt of 1) and returns a u_char pointer to the data in that packet. (The <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> struct for that packet is not supplied.)<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a>, <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00119">119</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
References <a class="el" href="pcap_8c-source.html#l00105">singleton::hdr</a>, <a class="el" href="pcap_8c-source.html#l00069">pcap_dispatch()</a>, and <a class="el" href="pcap_8c-source.html#l00106">singleton::pkt</a>.    </td>
  </tr>
</table>
<a name="a41" doxytag="funcs/pcap.h::pcap_next_ex"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_next_ex </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> **&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>pkt_header</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u_char **&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>pkt_data</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Read a packet from an interface or from an offline capture.
<p>
This function is used to retrieve the next available packet, bypassing the callback method traditionally provided by libpcap.<p>
pcap_next_ex fills the pkt_header and pkt_data parameters (see <a class="el" href="group__wpcap__fn.html#a0">pcap_handler()</a>) with the pointers to the header and to the data of the next captured packet.<p>
The return value can be:<ul>
<li>1 if the packet has been read without problems</li><li>0 if the timeout set with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> has elapsed. In this case pkt_header and pkt_data don't point to a valid packet</li><li>-1 if an error occurred</li><li>-2 if EOF was reached reading from an offline capture</li></ul>
<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a>, <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a>, <a class="el" href="group__wpcap__fn.html#a0">pcap_handler()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00148">148</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
References <a class="el" href="pcap_8c-source.html#l00133">pkt_for_fakecallback::hdr</a>, <a class="el" href="savefile_8c-source.html#l00619">pcap_offline_read()</a>, <a class="el" href="Pcap-win32_8c-source.html#l00079">pcap_read()</a>, <a class="el" href="pcap-remote_8c-source.html#l00203">pcap_read_nocb_remote()</a>, <a class="el" href="pcap-remote_8c-source.html#l00761">pcap_startcapture_remote()</a>, and <a class="el" href="pcap_8c-source.html#l00134">pkt_for_fakecallback::pkt</a>.
<p>
Referenced by <a class="el" href="daemon_8c-source.html#l01323">daemon_thrdatamain()</a>.    </td>
  </tr>
</table>
<a name="a2" doxytag="funcs/pcap.h::pcap_open_dead"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="group__wpcap__def.html#a2">pcap_t</a>* pcap_open_dead </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>linktype</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>snaplen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Deprecated: use the <a class="el" href="group__remote__func.html#a3">pcap_open()</a> instead.</b> Creates a pcap_t structure without starting a capture.
<p>
<a class="el" href="group__wpcap__fn.html#a2">pcap_open_dead()</a> is used for creating a pcap_t structure to use when calling the other functions in libpcap. It is typically used when just using libpcap for compiling BPF code.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a>, <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a>, <a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a>, <a class="el" href="group__wpcap__fn.html#a16">pcap_setfilter()</a>, <a class="el" href="group__wpcap__fn.html#a30">pcap_close()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00634">634</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
References <a class="el" href="incs_2pcap_8h-source.html#l00070">pcap_t</a>.
<p>
Referenced by <a class="el" href="gencode_8c-source.html#l00364">pcap_compile_nopcap()</a>.    </td>
  </tr>
</table>
<a name="a1" doxytag="funcs/pcap.h::pcap_open_live"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="group__wpcap__def.html#a2">pcap_t</a>* pcap_open_live </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>device</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>snaplen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>promisc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>to_ms</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>ebuf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Deprecated: use the <a class="el" href="group__remote__func.html#a3">pcap_open()</a> instead.</b> Opens a physical interface for live capture.
<p>
<a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> is used to obtain a packet capture descriptor to look at packets on the network. device is a string that specifies the network device to open; on Linux systems with 2.2 or later kernels, a device argument of "any" or NULL can be used to capture packets from all interfaces. snaplen specifies the maximum number of bytes to capture. promisc specifies if the interface is to be put into promiscuous mode. (Note that even if this parameter is false, the interface could well be in promiscuous mode for some other reason.) For now, this doesn't work on the "any" device; if an argument of "any" or NULL is supplied, the promisc flag is ignored. to_ms specifies the read timeout in milliseconds. The read timeout is used to arrange that the read not necessarily return immediately when a packet is seen, but that it wait for some amount of time to allow more packets to arrive and to read multiple packets from the OS kernel in one operation. Not all platforms support a read timeout; on platforms that don't, the read timeout is ignored. errbuf is used to return error or warning text. It will be set to error text when <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> fails and returns NULL. errbuf may also be set to warning text when <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> succeds; to detect this case the caller should store a zero length string in errbuf before calling <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> and display the warning to the user if errbuf is no longer a zero-length string.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a>, <a class="el" href="group__wpcap__fn.html#a2">pcap_open_dead()</a>, <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a>, <a class="el" href="group__wpcap__fn.html#a30">pcap_close()</a> </dd></dl>
    </td>
  </tr>
</table>
<a name="a3" doxytag="funcs/pcap.h::pcap_open_offline"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="group__wpcap__def.html#a2">pcap_t</a>* pcap_open_offline </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>fname</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>errbuf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Deprecated: use the <a class="el" href="group__remote__func.html#a3">pcap_open()</a> instead.</b> Opens a savefile in the tcpdump/libpcap format to read the packets.
<p>
<a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a> is called to open a "savefile" for reading. fname specifies the name of the file to open. The file has the same format as those used by tcpdump(1) and tcpslice(1). The name "-" in a synonym for stdin. errbuf is used to return error text and is only set when <a class="el" href="group__wpcap__fn.html#a3">pcap_open_offline()</a> fails and returns NULL.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a4">pcap_dump_open()</a>, <a class="el" href="group__wpcap__fn.html#a7">pcap_findalldevs()</a>, <a class="el" href="group__wpcap__fn.html#a30">pcap_close()</a> </dd></dl>

<p>
Definition at line <a class="el" href="savefile_8c-source.html#l00387">387</a> of file <a class="el" href="savefile_8c-source.html">savefile.c</a>.
<p>
References <a class="el" href="incs_2pcap_8h-source.html#l00067">bpf_u_int32</a>, <a class="el" href="savefile_8c-source.html#l00338">linktype_to_dlt()</a>, <a class="el" href="savefile_8c-source.html#l00053">PATCHED_TCPDUMP_MAGIC</a>, <a class="el" href="gencode_8c-source.html#l00103">pcap_fddipad</a>, <a class="el" href="pcap_8c-source.html#l00617">pcap_strerror()</a>, <a class="el" href="incs_2pcap_8h-source.html#l00070">pcap_t</a>, <a class="el" href="Packet_8h-source.html#l00188">PCAP_VERSION_MAJOR</a>, <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>, <a class="el" href="savefile_8c-source.html#l00376">swap_hdr()</a>, and <a class="el" href="Packet_8h-source.html#l00187">TCPDUMP_MAGIC</a>.
<p>
Referenced by <a class="el" href="pcap__filter_8c-source.html#l00035">main()</a>, and <a class="el" href="pcap-new_8c-source.html#l00881">pcap_open()</a>.    </td>
  </tr>
</table>
<a name="a27" doxytag="funcs/pcap.h::pcap_perror"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void pcap_perror </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>prefix</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
prints the text of the last pcap library error on stderr, prefixed by prefix.
<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a28">pcap_geterr()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00481">481</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.    </td>
  </tr>
</table>
<a name="a34" doxytag="funcs/pcap.h::pcap_sendpacket"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_sendpacket </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u_char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>buf</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>size</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Sends a raw packet.
<p>
This function allows to send a raw packet to the network. p is the interface that will be used to send the packet, buf contains the data of the packet to send (including the various protocol headers), size is the dimension of the buffer pointed by buf, i.e. the size of the packet to send. The MAC CRC doesn't need to be included, because it is transparently calculated and added by the network interface driver. The return value is 0 if the packet is succesfully sent, -1 otherwise.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Pcap-win32_8c-source.html#l00337">337</a> of file <a class="el" href="Pcap-win32_8c-source.html">Pcap-win32.c</a>.
<p>
References <a class="el" href="Packet32_8c-source.html#l00686">PacketAllocatePacket()</a>, <a class="el" href="Packet32_8c-source.html#l00707">PacketFreePacket()</a>, <a class="el" href="Packet32_8c-source.html#l00729">PacketInitPacket()</a>, <a class="el" href="Packet32_8c-source.html#l00809">PacketSendPacket()</a>, and <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.    </td>
  </tr>
</table>
<a name="a37" doxytag="funcs/pcap.h::pcap_sendqueue_alloc"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structpcap__send__queue.html">pcap_send_queue</a>* pcap_sendqueue_alloc </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">u_int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>memsize</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Allocate a send queue.
<p>
This function allocates a send queue, i.e. a buffer containing a set of raw packets that will be transimtted on the network with <a class="el" href="group__wpcap__fn.html#a40">pcap_sendqueue_transmit()</a>.<p>
memsize is the size, in bytes, of the queue, therefore it determines the maximum amount of data that the queue will contain.<p>
Use <a class="el" href="group__wpcap__fn.html#a39">pcap_sendqueue_queue()</a> to insert packets in the queue.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a39">pcap_sendqueue_queue()</a>, <a class="el" href="group__wpcap__fn.html#a40">pcap_sendqueue_transmit()</a>, <a class="el" href="group__wpcap__fn.html#a38">pcap_sendqueue_destroy()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Win32-Extensions_8c-source.html#l00069">69</a> of file <a class="el" href="Win32-Extensions_8c-source.html">Win32-Extensions.c</a>.    </td>
  </tr>
</table>
<a name="a38" doxytag="funcs/pcap.h::pcap_sendqueue_destroy"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void pcap_sendqueue_destroy </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structpcap__send__queue.html">pcap_send_queue</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>queue</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Destroy a send queue.
<p>
Deletes a send queue and frees all the memory associated with it.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a37">pcap_sendqueue_alloc()</a>, <a class="el" href="group__wpcap__fn.html#a39">pcap_sendqueue_queue()</a>, <a class="el" href="group__wpcap__fn.html#a40">pcap_sendqueue_transmit()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Win32-Extensions_8c-source.html#l00094">94</a> of file <a class="el" href="Win32-Extensions_8c-source.html">Win32-Extensions.c</a>.    </td>
  </tr>
</table>
<a name="a39" doxytag="funcs/pcap.h::pcap_sendqueue_queue"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_sendqueue_queue </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structpcap__send__queue.html">pcap_send_queue</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>queue</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const struct <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>pkt_header</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const u_char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>pkt_data</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Add a packet to a send queue.
<p>
<a class="el" href="group__wpcap__fn.html#a39">pcap_sendqueue_queue()</a> adds a packet at the end of the send queue pointed by the queue parameter. pkt_header points to a <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> structure with the timestamp and the length of the packet, pkt_data points to a buffer with the data of the packet.<p>
The <a class="el" href="structpcap__pkthdr.html">pcap_pkthdr</a> structure is the same used by WinPcap and libpcap to store the packets in a file, therefore sending a capture file is straightforward. 'Raw packet' means that the sending application will have to include the protocol headers, since every packet is sent to the network 'as is'. The CRC of the packets needs not to be calculated, because it will be transparently added by the network interface.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a37">pcap_sendqueue_alloc()</a>, <a class="el" href="group__wpcap__fn.html#a40">pcap_sendqueue_transmit()</a>, <a class="el" href="group__wpcap__fn.html#a38">pcap_sendqueue_destroy()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Win32-Extensions_8c-source.html#l00101">101</a> of file <a class="el" href="Win32-Extensions_8c-source.html">Win32-Extensions.c</a>.    </td>
  </tr>
</table>
<a name="a40" doxytag="funcs/pcap.h::pcap_sendqueue_transmit"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> u_int pcap_sendqueue_transmit </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structpcap__send__queue.html">pcap_send_queue</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>queue</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sync</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Sends a queue of raw packets to the network.
<p>
This function transmits the content of a queue to the wire. p is a pointer to the adapter on which the packets will be sent, queue points to a <a class="el" href="structpcap__send__queue.html">pcap_send_queue</a> structure containing the packets to send (see <a class="el" href="group__wpcap__fn.html#a37">pcap_sendqueue_alloc()</a> and <a class="el" href="group__wpcap__fn.html#a39">pcap_sendqueue_queue()</a>), sync determines if the send operation must be synchronized: if it is non-zero, the packets are sent respecting the timestamps, otherwise they are sent as fast as possible.<p>
The return value is the amount of bytes actually sent. If it is smaller than the size parameter, an error occurred during the send. The error can be caused by a driver/adapter problem or by an inconsistent/bogus send queue.<p>
<dl compact><dt><b>Note:</b></dt><dd>Using this function is more efficient than issuing a series of <a class="el" href="group__wpcap__fn.html#a34">pcap_sendpacket()</a>, because the packets are buffered in the kernel driver, so the number of context switches is reduced. Therefore, expect a better throughput when using pcap_sendqueue_transmit.<p>
When Sync is set to TRUE, the packets are synchronized in the kernel with a high precision timestamp. This requires a non-negligible amount of CPU, but allows normally to send the packets with a precision of some microseconds (depending on the accuracy of the performance counter of the machine). Such a precision cannot be reached sending the packets with <a class="el" href="group__wpcap__fn.html#a34">pcap_sendpacket()</a>.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a37">pcap_sendqueue_alloc()</a>, <a class="el" href="group__wpcap__fn.html#a39">pcap_sendqueue_queue()</a>, <a class="el" href="group__wpcap__fn.html#a38">pcap_sendqueue_destroy()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Win32-Extensions_8c-source.html#l00120">120</a> of file <a class="el" href="Win32-Extensions_8c-source.html">Win32-Extensions.c</a>.    </td>
  </tr>
</table>
<a name="a32" doxytag="funcs/pcap.h::pcap_setbuff"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> fn int pcap_setbuff </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>dim</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Sets the size of the kernel buffer associated with an adapter.
<p>
<em>dim</em> specifies the size of the buffer in bytes. The return value is 0 when the call succeeds, -1 otherwise. If an old buffer was already created with a previous call to <a class="el" href="group__wpcap__fn.html#a32">pcap_setbuff()</a>, it is deleted and its content is discarded. <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> creates a 1 MByte buffer by default.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a>, <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Pcap-win32_8c-source.html#l00359">359</a> of file <a class="el" href="Pcap-win32_8c-source.html">Pcap-win32.c</a>.
<p>
References <a class="el" href="Packet32_8c-source.html#l01157">PacketSetBuff()</a>, and <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.    </td>
  </tr>
</table>
<a name="a16" doxytag="funcs/pcap.h::pcap_setfilter"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_setfilter </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structbpf__program.html">bpf_program</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>fp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Associates a filter to a capture.
<p>
<a class="el" href="group__wpcap__fn.html#a16">pcap_setfilter()</a> is used to specify a filter program. fp is a pointer to a <a class="el" href="structbpf__program.html">bpf_program</a> struct, usually the result of a call to <a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a>. -1 is returned on failure, in which case <a class="el" href="group__wpcap__fn.html#a28">pcap_geterr()</a> may be used to display the error text; 0 is returned on success.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a>, <a class="el" href="group__wpcap__fn.html#a15">pcap_compile_nopcap()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Pcap-win32_8c-source.html#l00292">292</a> of file <a class="el" href="Pcap-win32_8c-source.html">Pcap-win32.c</a>.
<p>
References <a class="el" href="Packet32_8c-source.html#l01183">PacketSetBpf()</a>, <a class="el" href="pcap-remote_8c-source.html#l01228">pcap_setfilter_remote()</a>, <a class="el" href="pcap_8c-source.html#l00590">pcap_win32strerror()</a>, and <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.
<p>
Referenced by <a class="el" href="daemon_8c-source.html#l01147">daemon_unpackapplyfilter()</a>, and <a class="el" href="pcap__filter_8c-source.html#l00035">main()</a>.    </td>
  </tr>
</table>
<a name="a35" doxytag="funcs/pcap.h::pcap_setmintocopy"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_setmintocopy </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>size</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Sets the minumum amount of data received by the kernel in a single call.
<p>
<a class="el" href="group__wpcap__fn.html#a35">pcap_setmintocopy()</a> changes the minimum amount of data in the kernel buffer that causes a read from the application to return (unless the timeout expires). If the value of <em>size</em> is large, the kernel is forced to wait the arrival of several packets before copying the data to the user. This guarantees a low number of system calls, i.e. low processor usage, and is a good setting for applications like packet-sniffers and protocol analyzers. Vice versa, in presence of a small value for this variable, the kernel will copy the packets as soon as the application is ready to receive them. This is useful for real time applications that need the best responsiveness from the kernel.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a>, <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Pcap-win32_8c-source.html#l00377">377</a> of file <a class="el" href="Pcap-win32_8c-source.html">Pcap-win32.c</a>.
<p>
References <a class="el" href="Packet32_8c-source.html#l00917">PacketSetMinToCopy()</a>, and <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.    </td>
  </tr>
</table>
<a name="a33" doxytag="funcs/pcap.h::pcap_setmode"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_setmode </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>mode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Win32 Specific.</b> Sets the working mode of the interface p to mode.
<p>
Valid values for mode are MODE_CAPT (default capture mode) and MODE_STAT (statistical mode). See the tutorial "<a class="el" href="group__wpcap__tut9.html">Gathering Statistics on the network traffic</a> " for details about statistical mode. 
<p>
Definition at line <a class="el" href="Pcap-win32_8c-source.html#l00318">318</a> of file <a class="el" href="Pcap-win32_8c-source.html">Pcap-win32.c</a>.
<p>
References <a class="el" href="Packet32_8c-source.html#l00959">PacketSetMode()</a>, and <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.    </td>
  </tr>
</table>
<a name="a5" doxytag="funcs/pcap.h::pcap_setnonblock"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_setnonblock </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>nonblock</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>errbuf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Switches between blocking and nonblocking mode.
<p>
<a class="el" href="group__wpcap__fn.html#a5">pcap_setnonblock()</a> puts a capture descriptor, opened with <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, into "non-blocking" mode, or takes it out of "non-blocking" mode, depending on whether the nonblock argument is non-zero or zero. It has no effect on "savefiles". If there is an error, -1 is returned and errbuf is filled in with an appropriate error message; otherwise, 0 is returned. In "non-blocking" mode, an attempt to read from the capture descriptor with <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> will, if no packets are currently available to be read, return 0 immediately rather than blocking waiting for packets to arrive. <a class="el" href="group__wpcap__fn.html#a12">pcap_loop()</a> and <a class="el" href="group__wpcap__fn.html#a18">pcap_next()</a> will not work in "non-blocking" mode.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a6">pcap_getnonblock()</a>, <a class="el" href="group__wpcap__fn.html#a11">pcap_dispatch()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00528">528</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
References <a class="el" href="Packet32_8c-source.html#l01131">PacketSetReadTimeout()</a>, <a class="el" href="pcap_8c-source.html#l00617">pcap_strerror()</a>, <a class="el" href="pcap_8c-source.html#l00590">pcap_win32strerror()</a>, and <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.    </td>
  </tr>
</table>
<a name="a20" doxytag="funcs/pcap.h::pcap_snapshot"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_snapshot </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>p</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the dimension of the packet portion (in bytes) that is delivered to the application.
<p>
<a class="el" href="group__wpcap__fn.html#a20">pcap_snapshot()</a> returns the snapshot length specified when pcap_open_live was called.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a>, <a class="el" href="group__wpcap__fn.html#a14">pcap_compile()</a>, <a class="el" href="group__wpcap__fn.html#a15">pcap_compile_nopcap()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00438">438</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
Referenced by <a class="el" href="gencode_8c-source.html#l00310">pcap_compile()</a>.    </td>
  </tr>
</table>
<a name="a24" doxytag="funcs/pcap.h::pcap_stats"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_stats </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structpcap__stat.html">pcap_stat</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>ps</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b> Discouraged, Use <a class="el" href="group__wpcap__fn.html#a44">pcap_stats_ex()</a> instead</b>.<br>
 Returns statistics on current capture.
<p>
<a class="el" href="group__wpcap__fn.html#a24">pcap_stats()</a> returns 0 and fills in a <a class="el" href="structpcap__stat.html">pcap_stat</a> struct. The values represent packet statistics from the start of the run to the time of the call. If there is an error or the underlying packet capture doesn't support packet statistics, -1 is returned and the error text can be obtained with <a class="el" href="group__wpcap__fn.html#a27">pcap_perror()</a> or <a class="el" href="group__wpcap__fn.html#a28">pcap_geterr()</a>. <a class="el" href="group__wpcap__fn.html#a24">pcap_stats()</a> is supported only on live captures, not on "savefiles"; no statistics are stored in "savefiles", so no statistics are available when reading from a "savefile".<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a44">pcap_stats_ex()</a>, <a class="el" href="group__wpcap__fn.html#a1">pcap_open_live()</a> </dd></dl>

<p>
Definition at line <a class="el" href="Pcap-win32_8c-source.html#l00060">60</a> of file <a class="el" href="Pcap-win32_8c-source.html">Pcap-win32.c</a>.
<p>
References <a class="el" href="Packet32_8c-source.html#l01202">PacketGetStats()</a>, <a class="el" href="pcap-remote_8c-source.html#l00373">pcap_stats_remote()</a>, <a class="el" href="pcap_8c-source.html#l00590">pcap_win32strerror()</a>, and <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.
<p>
Referenced by <a class="el" href="daemon_8c-source.html#l01248">daemon_getstats()</a>, and <a class="el" href="daemon_8c-source.html#l00104">daemon_serviceloop()</a>.    </td>
  </tr>
</table>
<a name="a44" doxytag="funcs/pcap.h::pcap_stats_ex"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pcap_stats_ex </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__wpcap__def.html#a2">pcap_t</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structpcap__stat.html">pcap_stat</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>ps</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b> Win32 Specific.</b> Returns statistics on current capture.
<p>
This functions has the same purpose and behavior of <a class="el" href="group__wpcap__fn.html#a24">pcap_stats()</a>, but it returns a further counter, the number of packets that are actually captured.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a24">pcap_stats()</a> </dd></dl>

<p>
Referenced by <a class="el" href="Win32-Extensions_8c-source.html#l00051">pcap_stats_ex()</a>.    </td>
  </tr>
</table>
<a name="a29" doxytag="funcs/pcap.h::pcap_strerror"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* pcap_strerror </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>error</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<a class="el" href="group__wpcap__fn.html#a29">pcap_strerror()</a> is provided in case strerror() isn't available.
<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__wpcap__fn.html#a27">pcap_perror()</a>, <a class="el" href="group__wpcap__fn.html#a28">pcap_geterr()</a> </dd></dl>

<p>
Definition at line <a class="el" href="pcap_8c-source.html#l00617">617</a> of file <a class="el" href="pcap_8c-source.html">pcap.c</a>.
<p>
References <a class="el" href="sockutils_8c-source.html#l00064">snprintf</a>.
<p>
Referenced by <a class="el" href="inet_8c-source.html#l00300">add_addr_to_iflist()</a>, <a class="el" href="inet_8c-source.html#l00132">add_or_find_if()</a>, <a class="el" href="daemon_8c-source.html#l00599">daemon_AuthUserPwd()</a>, <a class="el" href="daemon_8c-source.html#l00444">daemon_checkauth()</a>, <a class="el" href="daemon_8c-source.html#l01147">daemon_unpackapplyfilter()</a>, <a class="el" href="rpcapd_8c-source.html#l00596">main_active()</a>, <a class="el" href="rpcapd_8c-source.html#l00478">main_passive()</a>, <a class="el" href="savefile_8c-source.html#l00669">pcap_dump_open()</a>, <a class="el" href="pcap-new_8c-source.html#l00150">pcap_findalldevs_ex()</a>, <a class="el" href="pcap_8c-source.html#l00498">pcap_getnonblock()</a>, <a class="el" href="pcap_8c-source.html#l00215">pcap_list_datalinks()</a>, <a class="el" href="Pcap-win32_8c-source.html#l00144">pcap_open_live()</a>, <a class="el" href="savefile_8c-source.html#l00387">pcap_open_offline()</a>, <a class="el" href="pcap-remote_8c-source.html#l00554">pcap_opensource_remote()</a>, <a class="el" href="pcap-new_8c-source.html#l00996">pcap_remoteact_accept()</a>, <a class="el" href="pcap_8c-source.html#l00528">pcap_setnonblock()</a>, <a class="el" href="pcap-remote_8c-source.html#l00761">pcap_startcapture_remote()</a>, and <a class="el" href="pcap-remote_8c-source.html#l00133">rpcap_deseraddr()</a>.    </td>
  </tr>
</table>

<hr>
<p align="right"><img border="0" src="winpcap_small.gif" align="absbottom" width="91" height="27">
documentation. Copyright (c) 2002-2003 Politecnico di Torino. All rights reserved.</p>
