from  mysql import *
import sys

if __name__ == "__main__":
   if len(sys.argv) < 2:
      print("donnez un fichier en entree")
      sys.exit(1)

   fichier = sys.argv[1]
   try:
      op = open(fichier, "r")
   except:
      print "ta mere"
      sys.exit(1)

   dbconfig = dbconfig()
   db2 = dbinterface(dbconfig)
   run = db2.IdSession("AZERT1222")
   print run
   corps = op.readlines()
   process = 0
   action = 0
   creation = 0
   buf=""
   for f in corps:
       traitement =  f.replace('\n', '')
       if traitement == "-- BEGIN":
          action=1
          buf=""
          continue
       if traitement == "-- END":
          action=0
          db2.addRegistry(buf, run)
          buf=""
          continue
       if action == 1:
          buf = buf + traitement + "\n" 
   op.close()
   print "toto"
