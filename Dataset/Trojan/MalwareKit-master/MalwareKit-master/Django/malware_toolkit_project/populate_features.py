import os
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'malware_toolkit_project.settings')

import django
django.setup()

from malware_toolkit.models import Feature, Function, Import, Header, Definition


def populate():
    # python_cat = add_cat('Python')
    avm_feature = add_feature('Anti-VM')

    add_func(feat=avm_feature, name="func1")

    add_func(feat=avm_feature, name="func2")


    # Print out what we have added to the user.
    for c in Feature.objects.all():
        for p in Function.objects.filter(name=c):
            print( "added")
            # print "- {0} - {1}".format(str(c), str(p))

def add_feature(feat, name):
    f = Feature.objects.get_or_create(feature_id=feat, name=name)[0]
    f.name=name
    # add_function(feat, feat.function)
    f.save()
    return p

def add_function(feature, func):
    f = Function.objects.get_or_create(name=func.name)[0]
    f.feature_id = feature
    f.imports = func.imports
    f.declaration = func.declaration
    f.definition = func.definition
    # for each line in body, new line
    f.save()
    return c

# Start execution here!
if __name__ == '__main__':
    print( "Starting Rango population script...")
    populate()
